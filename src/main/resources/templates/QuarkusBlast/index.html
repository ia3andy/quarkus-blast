{#include main.html}

<h1>Welcome to Quarkus Blast ü¶ä‚ù§Ô∏è </h1>
<div id="current-game">
    {#if game}
    {#fragment id=game}
    <div class="container text-center">
        <div class="score">
            {game.score}
        </div>
        <div class="game-grid container text-center">
            {#for row in game.grid()}
            <div class="row">
                {#for col in row}
                {#if col.type}
                <div class="col cell {col.type}" hx-trigger="blastQuark" hx-post="{uri:QuarkusBlast.play(game.id, col.row, col.column)}" hx-vals='js:\{type: event.detail.type.toUpperCase()}' hx-target="#current-game"
                     _="on dragover or dragenter halt the event
    then set the target's style.background to 'lightgray'
  on dragleave or drop set the target's style.background to ''
  on drop get event.dataTransfer.getData('text/plain')
    then send blastQuark(type:it)"
                >
                    {col.charge}
                </div>
                {#else}
                <div class="col cell blasted">

                </div>
                {/if}
                {/for}
            </div>
            {/for}
        </div>
        <div class="quark-picker container text-center">
            <div class="row" _="on dragstart call event.dataTransfer.setData('text/plain',target.textContent)">
            {#for type in global.quarkTypes}
                <div class="col quark-type {type}" draggable='true'>{type}</div>
            {/for}
            </div>

        </div>
    </div>
    {/fragment}
    {/if}

</div>

<button type="button" class="btn btn-primary" hx-post="{uri:QuarkusBlast.newGame()}" hx-target="#current-game">New Game</button>